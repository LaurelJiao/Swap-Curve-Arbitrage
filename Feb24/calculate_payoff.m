function f = calculate_payoff(error,LIBOR,swap,T,swap2,swap10,parameters,r_t)

payoffs = zeros(2221,1);
for i=1:2221 % maximum index for payoff
    if error(i) < -0.25/100
        % calculate the hedge ratio
        [delta1,delta2]= hedgeRatio(parameters(i,:),T,r_t(i,:),swap(i),swap2(i),swap10(i));
        % long swap2,swap10, short swap
        payoffs(i) =  ...
delta1*((-0.5*swap2(i)+ 0.5*LIBOR(i+6*22))* (1+0.5*LIBOR(i+6*22))-0.5*swap2(i)+ 0.5*LIBOR(i+12*22) ...
+ swapValue(swap2(i),r_t(i+22*12,:),parameters(i+22*12,:),1,1)) ...
+ delta2*((-0.5*swap10(i)+ 0.5*LIBOR(i+6*22))* (1+0.5*LIBOR(i+6*22)) -0.5*swap10(i) + 0.5*LIBOR(i+12*22)...
+ swapValue(swap10(i),r_t(i+22*12,:),parameters(i+22*12,:),9,1))...
+ (-1)*((-0.5*swap(i)+ 0.5*LIBOR(i+6*22))*(1+0.5*LIBOR(i+6*22)) - 0.5*swap(i) + 0.5*LIBOR(i+12*22)...
+ swapValue(swap(i),r_t(i+22*12,:),parameters(i+22*12,:),T-1,1));

    else if error(i) > 0.25/100
         % calculate the hedge ratio
        [delta1,delta2]= hedgeRatio(parameters(i,:),T,r_t(i,:),swap(i),swap2(i),swap10(i));
        % short swap2,swap10, long swap
        payoffs(i) =  ...
- delta1*((-0.5*swap2(i)+ 0.5*LIBOR(i+6*22))* (1+0.5*LIBOR(i+6*22))-0.5*swap2(i)+ 0.5*LIBOR(i+12*22) ...
+ swapValue(swap2(i),r_t(i+22*12,:),parameters(i+22*12,:),1,1)) ...
- delta2*((-0.5*swap10(i)+ 0.5*LIBOR(i+6*22))* (1+0.5*LIBOR(i+6*22)) -0.5*swap10(i) + 0.5*LIBOR(i+12*22)...
+ swapValue(swap10(i),r_t(i+22*12,:),parameters(i+22*12,:),9,1))...
+ 1 *((-0.5*swap(i)+ 0.5*LIBOR(i+6*22))*(1+0.5*LIBOR(i+6*22)) -0.5*swap(i) + 0.5*LIBOR(i+12*22)...
+ swapValue(swap(i),r_t(i+22*12,:),parameters(i+22*12,:),T-1,1));
 
        else payoffs(i) =0;
        end
    end
    
end

f = payoffs;
end
